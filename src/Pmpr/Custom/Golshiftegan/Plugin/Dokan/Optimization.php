<?php
/*   _______________________________________
    |  Obfuscated by PMPR - Php Obfuscator  |
    |             693b5a611c047             |
    |_______________________________________|
*/
 namespace Pmpr\Custom\Golshiftegan\Plugin\Dokan; use Pmpr\Custom\Golshiftegan\Container; class Optimization extends Container { private $allowed_scripts = []; private $allowed_styles = []; public function __construct() { $this->init_allowed_lists(); add_filter('show_admin_bar', '__return_false', PHP_INT_MAX); add_action('init', [$this, 'disable_wp_overheads'], 5); add_filter('dokan_dashboard_widget', [$this, 'remove_dokan_widgets'], 20); add_action('wp_enqueue_scripts', [$this, 'dequeue_assets'], 9999); add_action('template_redirect', [$this, 'extra_dequeue'], 9999); add_action('shutdown', [$this, 'log_remaining_assets'], 0); } private function init_allowed_lists() { $this->allowed_scripts = ['jquery', 'jquery-core', 'jquery-migrate', 'dokan-script', 'dokan-dashboard', 'dokan-vendor-core', 'dokan-select2-js', 'woocommerce', 'wc-add-to-cart']; $this->allowed_styles = ['dokan-style', 'woocommerce-general', 'woocommerce-layout', 'woocommerce-smallscreen', 'font-awesome-4-shim']; } private function is_vendor_dashboard() { return function_exists('dokan_is_seller_dashboard') && dokan_is_seller_dashboard(); } public function remove_dokan_widgets($wkyqguegmcukcsgq) { if (!$this->is_vendor_dashboard()) { return $wkyqguegmcukcsgq; } $iqwcisggcgecewgw = ['dokan_best_selling', 'dokan_top_earning', 'dokan_latest_orders', 'dokan_announcement', 'dokan_reviews', 'dokan_daily_sale', 'dokan_promotions', 'dokan_store_support']; foreach ($iqwcisggcgecewgw as $uusmaiomayssaecw) { unset($wkyqguegmcukcsgq[$uusmaiomayssaecw]); } return $wkyqguegmcukcsgq; } public function disable_wp_overheads() { if (!$this->is_vendor_dashboard()) { return; } show_admin_bar(false); remove_action('wp_head', 'print_emoji_detection_script', 7); remove_action('wp_print_styles', 'print_emoji_styles'); remove_action('rest_api_init', 'wp_oembed_register_route'); add_filter('embed_oembed_discover', '__return_false'); remove_action('wp_head', 'wp_oembed_add_discovery_links'); remove_action('wp_head', 'wp_oembed_add_host_js'); add_filter('heartbeat_send', '__return_false'); add_filter('should_load_separate_core_block_assets', '__return_false'); } public function dequeue_assets() { if (!$this->is_vendor_dashboard()) { return; } global $wp_scripts, $wp_styles; if (!isset($wp_scripts) || !isset($wp_styles)) { return; } foreach ($wp_scripts->queue as $eueuqacmukymcyya) { if (in_array($eueuqacmukymcyya, $this->allowed_scripts, true)) { continue; } if (empty($eueuqacmukymcyya)) { continue; } wp_dequeue_script($eueuqacmukymcyya); wp_deregister_script($eueuqacmukymcyya); $this->log("Dequeued script: {$eueuqacmukymcyya}"); } foreach ($wp_styles->queue as $eueuqacmukymcyya) { if (in_array($eueuqacmukymcyya, $this->allowed_styles, true)) { continue; } if (empty($eueuqacmukymcyya)) { continue; } if (str_contains($eueuqacmukymcyya, 'dokan')) { continue; } wp_dequeue_style($eueuqacmukymcyya); wp_deregister_style($eueuqacmukymcyya); $this->log("Dequeued style: {$eueuqacmukymcyya}"); } wp_dequeue_script('wc-cart-fragments'); wp_dequeue_script('wc-cart'); wp_dequeue_script('woocommerce-cart'); } public function extra_dequeue() { if (!$this->is_vendor_dashboard()) { return; } $gyskaqycyaywiiyi = ['admin-bar', 'sweetalert2', 'elementor-app-loader', 'elementor-pro-app', 'elementor-common', 'sourcebuster-js', 'serializejson', 'persian-elementor-datepicker-init', 'persian-elementor-datepicker', 'cmn__fndtn-front', 'cmn__fndtn-inline', 'cmn__fndtn-global', 'mdl__jll-datepicker', 'mdl__jll-dokan-dashboard']; foreach ($gyskaqycyaywiiyi as $ackqauiusooswkmw) { wp_dequeue_script($ackqauiusooswkmw); wp_deregister_script($ackqauiusooswkmw); wp_dequeue_style($ackqauiusooswkmw); wp_deregister_style($ackqauiusooswkmw); $this->log("Extra dequeued: {$ackqauiusooswkmw}"); } wp_dequeue_style('wp-block-library'); wp_dequeue_style('wp-block-library-theme'); wp_dequeue_style('wc-blocks-style'); } public function log_remaining_assets() { if (!$this->is_vendor_dashboard()) { return; } if (!defined('WP_DEBUG') || !WP_DEBUG) { return; } global $wp_scripts, $wp_styles; foreach ((array) $wp_scripts->queue as $ackqauiusooswkmw) { $this->log("[REMAIN SCRIPT] {$ackqauiusooswkmw}"); } foreach ((array) $wp_styles->queue as $ackqauiusooswkmw) { $this->log("[REMAIN STYLE] {$ackqauiusooswkmw}"); } } private function log($yaakimaumwqiaeei) { if (defined('WP_DEBUG') && WP_DEBUG) { error_log('[DDO] ' . $yaakimaumwqiaeei); } } }
